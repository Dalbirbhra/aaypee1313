<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">











<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>ESAPI - CPD Results</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
          </head>
  <body class="composite">
    <div id="banner">
                    <span id="bannerLeft">
    
            ESAPI
    
            </span>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
          
  

  
    
  
  
    
            <div class="xleft">
        Last Published: 2010-02-13
                      </div>
            <div class="xright">            <a href="http://www.esapi.org/" class="externalLink">ESAPI</a>
            
  

  
    
  
  
    
  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
           
  

  
    
  
  
    
                             <h5>Project Documentation</h5>
            <ul>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="project-info.html">Project Information</a>
                </li>
              
                
              
            
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
              
            <li class="expanded">
                    <a href="project-reports.html">Project Reports</a>
                  <ul>
                  
    <li class="none">
              <strong>CPD Report</strong>
        </li>
                  
    <li class="none">
                    <a href="findbugs.html">FindBugs Report</a>
          </li>
                  
    <li class="none">
                    <a href="apidocs/index.html">JavaDocs</a>
          </li>
                  
    <li class="none">
                    <a href="jdepend-report.html">JDepend</a>
          </li>
                  
    <li class="none">
                    <a href="pmd.html">PMD Report</a>
          </li>
                  
    <li class="none">
                    <a href="tlddoc/index.html">Taglibdoc documentation</a>
          </li>
                  
    <li class="none">
                    <a href="taglibvalidation.html">Tag library validation</a>
          </li>
                  
    <li class="none">
                    <a href="tagreference.html">Tag reference</a>
          </li>
                  
    <li class="none">
                    <a href="testapidocs/index.html">Test JavaDocs</a>
          </li>
              </ul>
        </li>
          </ul>
                                           <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
            <img alt="Built by Maven" src="./images/logos/maven-feather.png"></img>
          </a>
                       
  

  
    
  
  
    
        </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>CPD Results</h2>
<p>The following document contains the results of PMD's  <a href="http://pmd.sourceforge.net/cpd.html" class="externalLink">CPD</a> 4.2.2.</p>
</div>
<div class="section"><h2>Duplications</h2>
<p><table class="bodyTable"><tr class="a"><th>File</th>
<th>Line</th>
</tr>
<tr class="b"><td>org/owasp/esapi/codecs/Base64.java</td>
<td>164</td>
</tr>
<tr class="a"><td>org/owasp/esapi/codecs/Base64.java</td>
<td>226</td>
</tr>
<tr class="b"><td colspan='2'><div class="source"><pre>    private final static byte[] _URL_SAFE_ALPHABET =
    {
      (byte)'A', (byte)'B', (byte)'C', (byte)'D', (byte)'E', (byte)'F', (byte)'G',
      (byte)'H', (byte)'I', (byte)'J', (byte)'K', (byte)'L', (byte)'M', (byte)'N',
      (byte)'O', (byte)'P', (byte)'Q', (byte)'R', (byte)'S', (byte)'T', (byte)'U', 
      (byte)'V', (byte)'W', (byte)'X', (byte)'Y', (byte)'Z',
      (byte)'a', (byte)'b', (byte)'c', (byte)'d', (byte)'e', (byte)'f', (byte)'g',
      (byte)'h', (byte)'i', (byte)'j', (byte)'k', (byte)'l', (byte)'m', (byte)'n',
      (byte)'o', (byte)'p', (byte)'q', (byte)'r', (byte)'s', (byte)'t', (byte)'u', 
      (byte)'v', (byte)'w', (byte)'x', (byte)'y', (byte)'z',
      (byte)'0', (byte)'1', (byte)'2', (byte)'3', (byte)'4', (byte)'5', 
      (byte)'6', (byte)'7', (byte)'8', (byte)'9', (byte)'-', (byte)'_'</pre>
</div>
</td></tr>
<table class="bodyTable"></p>
<p><table class="bodyTable"><tr class="a"><th>File</th>
<th>Line</th>
</tr>
<tr class="b"><td>org/owasp/esapi/reference/JavaLogFactory.java</td>
<td>281</td>
</tr>
<tr class="a"><td>org/owasp/esapi/reference/Log4JLogFactory.java</td>
<td>254</td>
</tr>
<tr class="b"><td colspan='2'><div class="source"><pre>        	if (!jlogger.isEnabledFor( level )) return;
       	
        	User user = ESAPI.authenticator().getCurrentUser();
            
            // create a random session number for the user to represent the user's 'session', if it doesn't exist already
            String userSessionIDforLogging = &quot;unknown&quot;;

            try {
                HttpSession session = ESAPI.httpUtilities().getCurrentRequest().getSession( false );
                userSessionIDforLogging = (String)session.getAttribute(&quot;ESAPI_SESSION&quot;);
                // if there is no session ID for the user yet, we create one and store it in the user's session
	            if ( userSessionIDforLogging == null ) {
	            	userSessionIDforLogging = &quot;&quot;+ ESAPI.randomizer().getRandomInteger(0, 1000000);
	            	session.setAttribute(&quot;ESAPI_SESSION&quot;, userSessionIDforLogging);
	            }
            } catch( NullPointerException e ) {
            	// continue
            }
            
            // ensure there's something to log
            if ( message == null ) {
            	message = &quot;&quot;;
            }
            
            // ensure no CRLF injection into logs for forging records
            String clean = message.replace( '\n', '_' ).replace( '\r', '_' );
            if ( (ESAPI.securityConfiguration()).getLogEncodingRequired() ) {
            	clean = ESAPI.encoder().encodeForHTML(message);
                if (!message.equals(clean)) {
                    clean += &quot; (Encoded)&quot;;
                }
            }
            
            // convert the stack trace into something that can be logged
            if ( throwable != null ) {
            	String fqn = throwable.getClass().getName();
            	int index = fqn.lastIndexOf('.');
            	if ( index &gt; 0 ) fqn = fqn.substring(index + 1);
            	StackTraceElement ste = throwable.getStackTrace()[0];
            	clean += &quot;\n    &quot; + fqn + &quot; @ &quot; + ste.getClassName() + &quot;.&quot; + ste.getMethodName() + &quot;(&quot; + ste.getFileName() 
            		+ &quot;:&quot; + ste.getLineNumber() + &quot;)&quot;;
            }
            
            // create the message to log
            String msg = &quot;&quot;;
            if ( user != null ) {
            	msg = type + &quot;-&quot; + (success ? &quot;SUCCESS&quot; : &quot;FAILURE&quot; ) + &quot; &quot; + user.getAccountName() + &quot;@&quot;+ user.getLastHostAddress() +&quot;:&quot; + userSessionIDforLogging + &quot; -- &quot; + clean;
            }
            
            jlogger.log(level, msg, throwable);</pre>
</div>
</td></tr>
<table class="bodyTable"></p>
<p><table class="bodyTable"><tr class="a"><th>File</th>
<th>Line</th>
</tr>
<tr class="b"><td>org/owasp/esapi/codecs/JavaScriptCodec.java</td>
<td>121</td>
</tr>
<tr class="a"><td>org/owasp/esapi/codecs/MySQLCodec.java</td>
<td>194</td>
</tr>
<tr class="b"><td colspan='2'><div class="source"><pre>	private Character decodeCharacterMySQL( PushbackString input ) {
		input.mark();
		Character first = input.next();
		if ( first == null ) {
			input.reset();
			return null;
		}
		
		// if this is not an encoded character, return null
		if ( first.charValue() != '\\' ) {
			input.reset();
			return null;
		}

		Character second = input.next();
		if ( second == null ) {
			input.reset();
			return null;
		}
		
		if ( second.charValue() == '0' ) {
			return new Character( (char)0x00 );
		} else if ( second.charValue() == 'b' ) {
			return new Character( (char)0x08 );
		} else if ( second.charValue() == 't' ) {
			return new Character( (char)0x09 );
		} else if ( second.charValue() == 'n' ) {
			return new Character( (char)0x0a );
		} else if ( second.charValue() == 'r' ) {</pre>
</div>
</td></tr>
<table class="bodyTable"></p>
<p><table class="bodyTable"><tr class="a"><th>File</th>
<th>Line</th>
</tr>
<tr class="b"><td>org/owasp/esapi/codecs/CSSCodec.java</td>
<td>78</td>
</tr>
<tr class="a"><td>org/owasp/esapi/codecs/JavaScriptCodec.java</td>
<td>88</td>
</tr>
<tr class="b"><td colspan='2'><div class="source"><pre>	}

	/**
	 * {@inheritDoc}
	 * 
	 * Decodes a String that has been encoded for use in a JavaScript context.
	 */
	public String decode( String input ) {
		StringBuffer sb = new StringBuffer();
		PushbackString pbs = new PushbackString( input );
		while ( pbs.hasNext() ) {
			Character c = decodeCharacter( pbs );
			if ( c != null ) {
				sb.append( c );
			} else {
				sb.append( pbs.next() );
			}
		}
		return sb.toString();
	}


	/**
	 * {@inheritDoc}
	 * 
	 * Returns the decoded version of the character starting at index, or
	 * null if no decoding is possible.
	 * 
	 * Formats all are legal both upper/lower case:
	 *   \\a - special characters
	 *   \\xHH
	 *   \\uHHHH
	 */
	public Character decodeCharacter( PushbackString input ) {
		input.mark();
		Character first = input.next();
		if ( first == null ) {
			input.reset();
			return null;
		}

		// if this is not an encoded character, return null
		if ( first.charValue() != '\\' ) {
			input.reset();
			return null;
		}

		Character second = input.next();
		if ( second == null ) {
			input.reset();
			return null;
		}

		if ( second.charValue() == '0' ) {</pre>
</div>
</td></tr>
<table class="bodyTable"></p>
<p><table class="bodyTable"><tr class="a"><th>File</th>
<th>Line</th>
</tr>
<tr class="b"><td>org/owasp/esapi/reference/DefaultValidator.java</td>
<td>235</td>
</tr>
<tr class="a"><td>org/owasp/esapi/reference/DefaultValidator.java</td>
<td>291</td>
</tr>
<tr class="b"><td colspan='2'><div class="source"><pre>		try {
			if ( antiSamyPolicy == null ) {
				if (ESAPI.securityConfiguration().getResourceDirectory() == null) {
					
					//load via classpath
			    	ClassLoader loader = getClass().getClassLoader();
			        
			        InputStream in = null;
			        try {
			            in = loader.getResourceAsStream(&quot;antisamy-esapi.xml&quot;);
			            if (in != null) {
			            	antiSamyPolicy = Policy.getInstance(in);
			            }
			        } catch (Exception e) {
			        	antiSamyPolicy = null;
			            
			        } finally {
			            if (in != null) try { in.close (); } catch (Throwable ignore) {}
			        }
			        
			        if (antiSamyPolicy == null) {
			            throw new IllegalArgumentException (&quot;Can't load antisamy-esapi.xml as a classloader resource&quot;);
			        }
			        
				} else {
					//load via fileio
					antiSamyPolicy = Policy.getInstance( ESAPI.securityConfiguration().getResourceDirectory() + &quot;antisamy-esapi.xml&quot;);
				}
			}
			AntiSamy as = new AntiSamy();
			CleanResults test = as.scan(input, antiSamyPolicy);</pre>
</div>
</td></tr>
<table class="bodyTable"></p>
<p><table class="bodyTable"><tr class="a"><th>File</th>
<th>Line</th>
</tr>
<tr class="b"><td>org/owasp/esapi/codecs/CSSCodec.java</td>
<td>78</td>
</tr>
<tr class="a"><td>org/owasp/esapi/codecs/UnixCodec.java</td>
<td>53</td>
</tr>
<tr class="b"><td colspan='2'><div class="source"><pre>	}
	
	/**
	 * {@inheritDoc}
	 * 
	 * Decodes a String that has been encoded with \ 
	 */
	public String decode( String input ) {
		StringBuffer sb = new StringBuffer();
		PushbackString pbs = new PushbackString( input );
		while ( pbs.hasNext() ) {
			Character c = decodeCharacter( pbs );
			if ( c != null ) {
				sb.append( c );
			} else {
				sb.append( pbs.next() );
			}
		}
		return sb.toString();
	}
	
	
	/**
	 * {@inheritDoc}
	 * 
	 * Returns the decoded version of the character starting at index, or
	 * null if no decoding is possible.
	 * &lt;p&gt;
	 * Formats all are legal both upper/lower case:
	 *   \x - all special characters
	 *   
	 */
	public Character decodeCharacter( PushbackString input ) {
		input.mark();
		Character first = input.next();
		if ( first == null ) {
			input.reset();
			return null;
		}
		
		// if this is not an encoded character, return null
		if ( first.charValue() != '\\' ) {
			input.reset();
			return null;
		}

		Character second = input.next();</pre>
</div>
</td></tr>
<table class="bodyTable"></p>
<p><table class="bodyTable"><tr class="a"><th>File</th>
<th>Line</th>
</tr>
<tr class="b"><td>org/owasp/esapi/codecs/Base64.java</td>
<td>243</td>
</tr>
<tr class="a"><td>org/owasp/esapi/codecs/Base64.java</td>
<td>309</td>
</tr>
<tr class="b"><td colspan='2'><div class="source"><pre>    private final static byte[] _ORDERED_DECODABET =
    {   
      -9,-9,-9,-9,-9,-9,-9,-9,-9,                 // Decimal  0 -  8
      -5,-5,                                      // Whitespace: Tab and Linefeed
      -9,-9,                                      // Decimal 11 - 12
      -5,                                         // Whitespace: Carriage Return
      -9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,     // Decimal 14 - 26
      -9,-9,-9,-9,-9,                             // Decimal 27 - 31
      -5,                                         // Whitespace: Space
      -9,-9,-9,-9,-9,-9,-9,-9,-9,-9,              // Decimal 33 - 42
      -9,                                         // Plus sign at decimal 43
      -9,                                         // Decimal 44</pre>
</div>
</td></tr>
<table class="bodyTable"></p>
<p><table class="bodyTable"><tr class="a"><th>File</th>
<th>Line</th>
</tr>
<tr class="b"><td>org/owasp/esapi/codecs/Base64.java</td>
<td>166</td>
</tr>
<tr class="a"><td>org/owasp/esapi/codecs/Base64.java</td>
<td>295</td>
</tr>
<tr class="b"><td colspan='2'><div class="source"><pre>      (byte)'A', (byte)'B', (byte)'C', (byte)'D', (byte)'E', (byte)'F', (byte)'G',
      (byte)'H', (byte)'I', (byte)'J', (byte)'K', (byte)'L', (byte)'M', (byte)'N',
      (byte)'O', (byte)'P', (byte)'Q', (byte)'R', (byte)'S', (byte)'T', (byte)'U',
      (byte)'V', (byte)'W', (byte)'X', (byte)'Y', (byte)'Z',
      (byte)'_',</pre>
</div>
</td></tr>
<table class="bodyTable"></p>
<p><table class="bodyTable"><tr class="a"><th>File</th>
<th>Line</th>
</tr>
<tr class="b"><td>org/owasp/esapi/codecs/Base64.java</td>
<td>183</td>
</tr>
<tr class="a"><td>org/owasp/esapi/codecs/Base64.java</td>
<td>309</td>
</tr>
<tr class="b"><td colspan='2'><div class="source"><pre>    private final static byte[] _URL_SAFE_DECODABET =
    {   
      -9,-9,-9,-9,-9,-9,-9,-9,-9,                 // Decimal  0 -  8
      -5,-5,                                      // Whitespace: Tab and Linefeed
      -9,-9,                                      // Decimal 11 - 12
      -5,                                         // Whitespace: Carriage Return
      -9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,-9,     // Decimal 14 - 26
      -9,-9,-9,-9,-9,                             // Decimal 27 - 31
      -5,                                         // Whitespace: Space
      -9,-9,-9,-9,-9,-9,-9,-9,-9,-9,              // Decimal 33 - 42</pre>
</div>
</td></tr>
<table class="bodyTable"></p>
<p><table class="bodyTable"><tr class="a"><th>File</th>
<th>Line</th>
</tr>
<tr class="b"><td>org/owasp/esapi/codecs/Base64.java</td>
<td>169</td>
</tr>
<tr class="a"><td>org/owasp/esapi/codecs/Base64.java</td>
<td>299</td>
</tr>
<tr class="b"><td colspan='2'><div class="source"><pre>      (byte)'_',
      (byte)'a', (byte)'b', (byte)'c', (byte)'d', (byte)'e', (byte)'f', (byte)'g',
      (byte)'h', (byte)'i', (byte)'j', (byte)'k', (byte)'l', (byte)'m', (byte)'n',
      (byte)'o', (byte)'p', (byte)'q', (byte)'r', (byte)'s', (byte)'t', (byte)'u',
      (byte)'v', (byte)'w', (byte)'x', (byte)'y', (byte)'z'</pre>
</div>
</td></tr>
<table class="bodyTable"></p>
<p><table class="bodyTable"><tr class="a"><th>File</th>
<th>Line</th>
</tr>
<tr class="b"><td>org/owasp/esapi/reference/IntegerAccessReferenceMap.java</td>
<td>91</td>
</tr>
<tr class="a"><td>org/owasp/esapi/reference/RandomAccessReferenceMap.java</td>
<td>103</td>
</tr>
<tr class="b"><td colspan='2'><div class="source"><pre>	}
	
	/**
	* {@inheritDoc}
	*/
	public String removeDirectReference(Object direct) throws AccessControlException {
		String indirect = (String)dtoi.get(direct);
		if ( indirect != null ) {
			itod.remove(indirect);
			dtoi.remove(direct);
		}
		return indirect;
	}

	/**
	* {@inheritDoc}
	*/
	final public void update(Set directReferences) {
		HashMap dtoi_old = (HashMap) dtoi.clone();
		dtoi.clear();
		itod.clear();

		Iterator i = directReferences.iterator();
		while (i.hasNext()) {
			Object direct = i.next();

			// get the old indirect reference
			String indirect = (String) dtoi_old.get(direct);

			// if the old reference is null, then create a new one that doesn't
			// collide with any existing indirect references
			if (indirect == null) {
				indirect = getUniqueRandomReference();</pre>
</div>
</td></tr>
<table class="bodyTable"></p>
<p><table class="bodyTable"><tr class="a"><th>File</th>
<th>Line</th>
</tr>
<tr class="b"><td>org/owasp/esapi/codecs/OracleCodec.java</td>
<td>59</td>
</tr>
<tr class="a"><td>org/owasp/esapi/codecs/UnixCodec.java</td>
<td>52</td>
</tr>
<tr class="b"><td colspan='2'><div class="source"><pre>        return &quot;^&quot; + c;
	}
	
	/**
	 * {@inheritDoc}
	 * 
	 * Decodes a String that has been encoded with ^ 
	 */
	public String decode( String input ) {
		StringBuffer sb = new StringBuffer();
		PushbackString pbs = new PushbackString( input );
		while ( pbs.hasNext() ) {
			Character c = decodeCharacter( pbs );
			if ( c != null ) {
				sb.append( c );
			} else {
				sb.append( pbs.next() );
			}
		}
		return sb.toString();
	}

	/**
	 * {@inheritDoc}
	 * 
	 * Returns the decoded version of the character starting at index, or
	 * null if no decoding is possible.
	 * &lt;p&gt;
	 * Formats all are legal both upper/lower case:
	 *   ^x - all special characters
	 */
	public Character decodeCharacter( PushbackString input ) {
		input.mark();
		Character first = input.next();
		if ( first == null ) {
			input.reset();
			return null;
		}
		
		// if this is not an encoded character, return null
		if ( first.charValue() != '^' ) {</pre>
</div>
</td></tr>
<table class="bodyTable"></p>
<p><table class="bodyTable"><tr class="a"><th>File</th>
<th>Line</th>
</tr>
<tr class="b"><td>org/owasp/esapi/codecs/JavaScriptCodec.java</td>
<td>87</td>
</tr>
<tr class="a"><td>org/owasp/esapi/codecs/PercentCodec.java</td>
<td>138</td>
</tr>
<tr class="b"><td colspan='2'><div class="source"><pre>		return sb.toString();
	}
	
	/**
	 * {@inheritDoc}
	 * 
	 * Decode string encoded with percent characters
	 * 
	 * @param input
	 * 			encoded string using percent characters (such as URL encoding)
	 */
	public String decode( String input ) {
		StringBuffer sb = new StringBuffer();
		PushbackString pbs = new PushbackString( input );
		while ( pbs.hasNext() ) {
			Character c = decodeCharacter( pbs );
			if ( c != null ) {
				sb.append( c );
			} else {
				sb.append( pbs.next() );
			}
		}
		return sb.toString();
	}
	
	/**
	 * {@inheritDoc}
	 * 
	 * Formats all are legal both upper/lower case:
	 *   %hh;
	 *   
	 * @param input
	 * 			encoded character using percent characters (such as URL encoding)
	 */
	public Character decodeCharacter( PushbackString input ) {
		input.mark();
		Character first = input.next();
		if ( first == null ) {
			input.reset();
			return null;
		}
		
		// if this is not an encoded character, return null
		if ( first.charValue() != '%' ) {</pre>
</div>
</td></tr>
<table class="bodyTable"></p>
<p><table class="bodyTable"><tr class="a"><th>File</th>
<th>Line</th>
</tr>
<tr class="b"><td>org/owasp/esapi/codecs/CSSCodec.java</td>
<td>78</td>
</tr>
<tr class="a"><td>org/owasp/esapi/codecs/HTMLEntityCodec.java</td>
<td>77</td>
</tr>
<tr class="b"><td colspan='2'><div class="source"><pre>	}

	/**
	 * {@inheritDoc}
	 * 
	 * Decodes quote-encoded string
	 */
	public String decode( String input ) {
		StringBuffer sb = new StringBuffer();
		PushbackString pbs = new PushbackString( input );
		while ( pbs.hasNext() ) {
			Character c = decodeCharacter( pbs );
			if ( c != null ) {
				sb.append( c );
			} else {
				sb.append( pbs.next() );
			}
		}
		return sb.toString();
	}
	
	/**
	 * {@inheritDoc}
	 *
	 * Returns the decoded version of the character starting at index, or
	 * null if no decoding is possible.
	 *
	 * Formats all are legal
	 *   '' decodes to '
	 */
	public Character decodeCharacter( PushbackString input ) {
		input.mark();
		Character first = input.next();
		if ( first == null ) {
			input.reset();
			return null;
		}

		// if this is not an encoded character, return null
		if ( first.charValue() != '\'' ) {</pre>
</div>
</td></tr>
<table class="bodyTable"></p>
<p><table class="bodyTable"><tr class="a"><th>File</th>
<th>Line</th>
</tr>
<tr class="b"><td>org/owasp/esapi/codecs/Base64.java</td>
<td>195</td>
</tr>
<tr class="a"><td>org/owasp/esapi/codecs/Base64.java</td>
<td>257</td>
</tr>
<tr class="b"><td colspan='2'><div class="source"><pre>      -9,                                         // Slash at decimal 47
      52,53,54,55,56,57,58,59,60,61,              // Numbers zero through nine
      -9,-9,-9,                                   // Decimal 58 - 60
      -1,                                         // Equals sign at decimal 61
      -9,-9,-9,                                   // Decimal 62 - 64
      0,1,2,3,4,5,6,7,8,9,10,11,12,13,            // Letters 'A' through 'N'
      14,15,16,17,18,19,20,21,22,23,24,25,        // Letters 'O' through 'Z'
      -9,-9,-9,-9,                                // Decimal 91 - 94</pre>
</div>
</td></tr>
<table class="bodyTable"></p>
<p><table class="bodyTable"><tr class="a"><th>File</th>
<th>Line</th>
</tr>
<tr class="b"><td>org/owasp/esapi/reference/FileBasedAccessController.java</td>
<td>512</td>
</tr>
<tr class="a"><td>org/owasp/esapi/reference/FileBasedAccessController.java</td>
<td>567</td>
</tr>
<tr class="b"><td colspan='2'><div class="source"><pre>	private Map loadDataRules(String ruleset) {
		Map map = new HashMap();
		InputStream is = null;

		try {
			is = new FileInputStream(new File(ESAPI.securityConfiguration().getResourceDirectory(), ruleset));
			String line = &quot;&quot;;
			while ((line = ESAPI.validator().safeReadLine(is, 500)) != null) {
				if (line.length() &gt; 0 &amp;&amp; line.charAt(0) != '#') {
					Rule rule = new Rule();
					String[] parts = line.split(&quot;\\|&quot;);
					rule.clazz = Class.forName(parts[0].trim());</pre>
</div>
</td></tr>
<table class="bodyTable"></p>
<p><table class="bodyTable"><tr class="a"><th>File</th>
<th>Line</th>
</tr>
<tr class="b"><td>org/owasp/esapi/codecs/MySQLCodec.java</td>
<td>158</td>
</tr>
<tr class="a"><td>org/owasp/esapi/codecs/OracleCodec.java</td>
<td>90</td>
</tr>
<tr class="b"><td colspan='2'><div class="source"><pre>	public Character decodeCharacter( PushbackString input ) {
		input.mark();
		Character first = input.next();
		if ( first == null ) {
			input.reset();
			return null;
		}

		// if this is not an encoded character, return null
		if ( first.charValue() != '\'' ) {
			input.reset();
			return null;
		}

		Character second = input.next();
		if ( second == null ) {
			input.reset();
			return null;
		}
		
		// if this is not an encoded character, return null
		if ( second.charValue() != '\'' ) {
			input.reset();
			return null;
		}
		return( new Character( '\'' ) );
	}</pre>
</div>
</td></tr>
<table class="bodyTable"></p>
</div>

      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">&#169;  
          2010
    
          The Open Web Application Security Project (OWASP)
          
  

  
    
  
  
    
  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
