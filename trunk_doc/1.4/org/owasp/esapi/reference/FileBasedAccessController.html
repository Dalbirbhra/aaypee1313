<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.4.2_18) on Mon Dec 15 12:54:28 EST 2008 -->
<TITLE>
FileBasedAccessController
</TITLE>

<META NAME="keywords" CONTENT="org.owasp.esapi.reference.FileBasedAccessController class">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    parent.document.title="FileBasedAccessController";
}
</SCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=3 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/FileBasedAccessController.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../org/owasp/esapi/reference/DefaultValidator.html" title="class in org.owasp.esapi.reference"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.Rule.html" title="class in org.owasp.esapi.reference"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="FileBasedAccessController.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>

</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;<A HREF="#nested_class_summary">NESTED</A>&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
org.owasp.esapi.reference</FONT>
<BR>
Class FileBasedAccessController</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../../resources/inherit.gif" ALT="extended by"><B>org.owasp.esapi.reference.FileBasedAccessController</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD><A HREF="../../../../org/owasp/esapi/AccessController.html" title="interface in org.owasp.esapi">AccessController</A></DD>
</DL>
<HR>
<DL>
<DT>public class <B>FileBasedAccessController</B><DT>extends java.lang.Object<DT>implements <A HREF="../../../../org/owasp/esapi/AccessController.html" title="interface in org.owasp.esapi">AccessController</A></DL>

<P>
Reference implementation of the AccessController interface. This reference
 implementation uses a simple model for specifying a set of access control
 rules. Many organizations will want to create their own implementation of the
 methods provided in the AccessController interface.
 <P>
 This reference implementation uses a simple scheme for specifying the rules.
 The first step is to create a namespace for the resources being accessed. For
 files and URL's, this is easy as they already have a namespace. Be extremely
 careful about canonicalizing when relying on information from the user in an
 access control decision.
 <P>
 For functions, data, and services, you will have to come up with your own
 namespace for the resources being accessed. You might simply define a flat
 namespace with a list of category names. For example, you might specify
 'FunctionA', 'FunctionB', and 'FunctionC'. Or you can create a richer
 namespace with a hierarchical structure, such as:
 <P>
 /functions
 <ul>
 <li>purchasing</li>
 <li>shipping</li>
 <li>inventory</li>
 </ul>
 /admin
 <ul>
 <li>createUser</li>
 <li>deleteUser</li>
 </ul>
 Once you've defined your namespace, you have to work out the rules that
 govern access to the different parts of the namespace. This implementation
 allows you to attach a simple access control list (ACL) to any part of the
 namespace tree. The ACL lists a set of roles that are either allowed or
 denied access to a part of the tree. You specify these rules in a textfile
 with a simple format.
 <P>
 There is a single configuration file supporting each of the five methods in
 the AccessController interface. These files are located in the ESAPI
 resources directory as specified when the JVM was started. The use of a
 default deny rule is STRONGLY recommended. The file format is as follows:
 
 <pre>
 path          | role,role   | allow/deny | comment
 ------------------------------------------------------------------------------------
 /banking/*    | user,admin  | allow      | authenticated users can access /banking
 /admin        | admin       | allow      | only admin role can access /admin
 /             | any         | deny       | default deny rule
 </pre>
 
 To find the matching rules, this implementation follows the general approach
 used in Java EE when matching HTTP requests to servlets in web.xml. The
 four mapping rules are used in the following order:
 <ul>
 <li>exact match, e.g. /access/login</li>
 <li>longest path prefix match, beginning / and ending /*, e.g. /access/* or /*</li>
 <li>extension match, beginning *., e.g. *.css</li>
 <li>default rule, specified by the single character pattern /</li>
 </ul>
<P>

<P>
<DL>
<DT><B>Since:</B></DT>
  <DD>June 1, 2007</DD>
<DT><B>Author:</B></DT>
  <DD>Jeff Williams (jeff.williams@aspectsecurity.com)</DD>
<DT><B>See Also:</B><DD><A HREF="../../../../org/owasp/esapi/AccessController.html" title="interface in org.owasp.esapi"><CODE>AccessController</CODE></A></DL>
<HR>

<P>
<!-- ======== NESTED CLASS SUMMARY ======== -->

<A NAME="nested_class_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Nested Class Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;class</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.Rule.html" title="class in org.owasp.esapi.reference">FileBasedAccessController.Rule</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The Class Rule.</TD>
</TR>
</TABLE>
&nbsp;
<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Field Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;java.util.Map</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.html#dataMap">dataMap</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The data map.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;<A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.Rule.html" title="class in org.owasp.esapi.reference">FileBasedAccessController.Rule</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.html#deny">deny</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A rule containing "deny".</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;java.util.Map</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.html#fileMap">fileMap</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The file map.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;java.util.Map</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.html#functionMap">functionMap</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The function map.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;<A HREF="../../../../org/owasp/esapi/Logger.html" title="interface in org.owasp.esapi">Logger</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.html#logger">logger</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The logger.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;java.util.Map</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.html#serviceMap">serviceMap</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The service map.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;java.util.Map</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.html#urlMap">urlMap</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The url map.</TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.html#FileBasedAccessController()">FileBasedAccessController</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=2><FONT SIZE="+2">
<B>Method Summary</B></FONT></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.html#assertAuthorizedForData(java.lang.String)">assertAuthorizedForData</A></B>(java.lang.String&nbsp;key)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{@inheritDoc}</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.html#assertAuthorizedForData(java.lang.String, java.lang.Object)">assertAuthorizedForData</A></B>(java.lang.String&nbsp;action,
                        java.lang.Object&nbsp;data)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks if the current user is authorized to access the referenced data.  This method simply returns if access is authorized.  
 It throws an AccessControlException if access is not authorized, or if the referenced data does not exist.
 <P>
 Specification:  The implementation should do the following:
 <ol>
 <li>Check to see if the resource exists and if not, throw an AccessControlException</li>
 <li>Use available information to make an access control decision</li>
      <ol type="a">
      <li>Ideally, this policy would be data driven</li>
 		<li>You can use the current User, roles, data type, data name, time of day, etc.</li>
  	<li>Access control decisions must deny by default</li>
      </ol>
 <li>If access is not permitted, throw an AccessControlException with details</li>
 </ol></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.html#assertAuthorizedForFile(java.lang.String)">assertAuthorizedForFile</A></B>(java.lang.String&nbsp;filepath)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks if an account is authorized to access the referenced file. The implementation should validate and canonicalize the 
 input to be sure the filepath is not malicious.
 <P>
 This method throws an AccessControlException if access is not authorized, or if the referenced File does not exist.
 If the User is authorized, this method simply returns.
 <P>
 Specification:  The implementation should do the following:
 <ol>
 <li>Check to see if the File exists and if not, throw an AccessControlException</li>
 <li>Use available information to make an access control decision</li>
      <ol type="a">
      <li>Ideally, this policy would be data driven</li>
 		<li>You can use the current User, roles, data type, data name, time of day, etc.</li>
  	<li>Access control decisions must deny by default</li>
      </ol>
 <li>If access is not permitted, throw an AccessControlException with details</li>
 </ol></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.html#assertAuthorizedForFunction(java.lang.String)">assertAuthorizedForFunction</A></B>(java.lang.String&nbsp;functionName)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks if an account is authorized to access the referenced function. The implementation should define the
 function "namespace" to be enforced. Choosing something simple like the class name of action classes or menu item
 names will make this implementation easier to use.
 <P>
 This method throws an AccessControlException if access is not authorized, or if the referenced function does not exist.
 If the User is authorized, this method simply returns.
 <P>
 Specification:  The implementation should do the following:
 <ol>
 <li>Check to see if the function exists and if not, throw an AccessControlException</li>
 <li>Use available information to make an access control decision</li>
      <ol type="a">
      <li>Ideally, this policy would be data driven</li>
 		<li>You can use the current User, roles, data type, data name, time of day, etc.</li>
  	<li>Access control decisions must deny by default</li>
      </ol>
 <li>If access is not permitted, throw an AccessControlException with details</li>
 </ol></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.html#assertAuthorizedForService(java.lang.String)">assertAuthorizedForService</A></B>(java.lang.String&nbsp;serviceName)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks if an account is authorized to access the referenced service. This can be used in applications that
 provide access to a variety of backend services.
 <P>
 This method throws an AccessControlException if access is not authorized, or if the referenced service does not exist.
 If the User is authorized, this method simply returns.
 <P>
 Specification:  The implementation should do the following:
 <ol>
 <li>Check to see if the service exists and if not, throw an AccessControlException</li>
 <li>Use available information to make an access control decision</li>
      <ol type="a">
      <li>Ideally, this policy would be data driven</li>
 		<li>You can use the current User, roles, data type, data name, time of day, etc.</li>
  	<li>Access control decisions must deny by default</li>
      </ol>
 <li>If access is not permitted, throw an AccessControlException with details</li>
 </ol></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.html#assertAuthorizedForURL(java.lang.String)">assertAuthorizedForURL</A></B>(java.lang.String&nbsp;url)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks if an account is authorized to access the referenced URL. The implementation should allow
 access to be granted to any part of the URL. Generally, this method should be invoked in the
 application's controller or a filter as follows:
 <PRE>ESAPI.accessController().assertAuthorizedForURL(request.getRequestURI().toString());</PRE> 
 
 This method throws an AccessControlException if access is not authorized, or if the referenced URL does not exist.
 If the User is authorized, this method simply returns.
 <P>
 Specification:  The implementation should do the following:
 <ol>
 <li>Check to see if the resource exists and if not, throw an AccessControlException</li>
 <li>Use available information to make an access control decision</li>
      <ol type="a">
      <li>Ideally, this policy would be data driven</li>
 		<li>You can use the current User, roles, data type, data name, time of day, etc.</li>
  	<li>Access control decisions must deny by default</li>
      </ol>
 <li>If access is not permitted, throw an AccessControlException with details</li>
 </ol></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;java.util.List</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.html#commaSplit(java.lang.String)">commaSplit</A></B>(java.lang.String&nbsp;input)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This method splits a String by the ',' and returns the result as a List.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.html#isAuthorizedForData(java.lang.String)">isAuthorizedForData</A></B>(java.lang.String&nbsp;key)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{@inheritDoc}</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.html#isAuthorizedForData(java.lang.String, java.lang.Object)">isAuthorizedForData</A></B>(java.lang.String&nbsp;action,
                    java.lang.Object&nbsp;data)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks if an account is authorized to access the referenced data, represented as an Object. 
 
 The implementation of this method should call assertAuthorizedForData(String action, Object data), and if an 
 AccessControlException is not thrown, this method should return true.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.html#isAuthorizedForFile(java.lang.String)">isAuthorizedForFile</A></B>(java.lang.String&nbsp;filepath)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks if an account is authorized to access the referenced file. 
 
 The implementation of this method should call assertAuthorizedForFile(String filepath), and if an AccessControlException 
 is not thrown, this method should return true.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.html#isAuthorizedForFunction(java.lang.String)">isAuthorizedForFunction</A></B>(java.lang.String&nbsp;functionName)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks if an account is authorized to access the referenced function. 
 
 The implementation of this method should call assertAuthorizedForFunction(String functionName), and if an 
 AccessControlException is not thrown, this method should return true.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.html#isAuthorizedForService(java.lang.String)">isAuthorizedForService</A></B>(java.lang.String&nbsp;serviceName)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks if an account is authorized to access the referenced service. This can be used in applications that
 provide access to a variety of back end services.
 
 The implementation of this method should call assertAuthorizedForService(String serviceName), and if an 
 AccessControlException is not thrown, this method should return true.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.html#isAuthorizedForURL(java.lang.String)">isAuthorizedForURL</A></B>(java.lang.String&nbsp;url)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks if an account is authorized to access the referenced URL. Generally, this method should be invoked in the
 application's controller or a filter as follows:
 <PRE>ESAPI.accessController().isAuthorizedForURL(request.getRequestURI().toString());</PRE>
 
 The implementation of this method should call assertAuthorizedForURL(String url), and if an AccessControlException is 
 not thrown, this method should return true. This way, if the user is not authorized, false would be returned, and the 
 exception would be logged.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;java.util.Map</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.html#loadDataRules(java.lang.String)">loadDataRules</A></B>(java.lang.String&nbsp;ruleset)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Loads access rules by storing them in a hashmap.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;java.util.Map</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.html#loadRules(java.lang.String)">loadRules</A></B>(java.lang.String&nbsp;ruleset)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Loads access rules by storing them in a hashmap.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.html#matchRule(java.util.Map, java.lang.Class, java.lang.String)">matchRule</A></B>(java.util.Map&nbsp;map,
          java.lang.Class&nbsp;clazz,
          java.lang.String&nbsp;action)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks to see if the current user has access to the specified Class and action.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.html#matchRule(java.util.Map, java.lang.String)">matchRule</A></B>(java.util.Map&nbsp;map,
          java.lang.String&nbsp;path)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks to see if the current user has access to the specified data, File, Object, etc.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.html#overlap(java.util.List, java.lang.String)">overlap</A></B>(java.util.List&nbsp;ruleActions,
        java.lang.String&nbsp;action)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This method merely checks to see if ruleActions contains the action requested.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.html#overlap(java.util.Set, java.util.Set)">overlap</A></B>(java.util.Set&nbsp;ruleRoles,
        java.util.Set&nbsp;userRoles)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Return true if there is overlap between the two sets.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;<A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.Rule.html" title="class in org.owasp.esapi.reference">FileBasedAccessController.Rule</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.html#searchForRule(java.util.Map, java.util.Set, java.lang.Class, java.lang.String)">searchForRule</A></B>(java.util.Map&nbsp;map,
              java.util.Set&nbsp;roles,
              java.lang.Class&nbsp;clazz,
              java.lang.String&nbsp;action)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Search for rule.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;<A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.Rule.html" title="class in org.owasp.esapi.reference">FileBasedAccessController.Rule</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.html#searchForRule(java.util.Map, java.util.Set, java.lang.String)">searchForRule</A></B>(java.util.Map&nbsp;map,
              java.util.Set&nbsp;roles,
              java.lang.String&nbsp;path)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Search for rule.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>private &nbsp;java.util.List</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.html#validateRoles(java.util.List)">validateRoles</A></B>(java.util.List&nbsp;roles)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks that the roles passed in contain only letters, numbers, and underscores.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TD><B>Methods inherited from class java.lang.Object</B></TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=1><FONT SIZE="+2">
<B>Field Detail</B></FONT></TD>
</TR>
</TABLE>

<A NAME="urlMap"><!-- --></A><H3>
urlMap</H3>
<PRE>
private java.util.Map <B>urlMap</B></PRE>
<DL>
<DD>The url map.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="functionMap"><!-- --></A><H3>
functionMap</H3>
<PRE>
private java.util.Map <B>functionMap</B></PRE>
<DL>
<DD>The function map.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="dataMap"><!-- --></A><H3>
dataMap</H3>
<PRE>
private java.util.Map <B>dataMap</B></PRE>
<DL>
<DD>The data map.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="fileMap"><!-- --></A><H3>
fileMap</H3>
<PRE>
private java.util.Map <B>fileMap</B></PRE>
<DL>
<DD>The file map.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="serviceMap"><!-- --></A><H3>
serviceMap</H3>
<PRE>
private java.util.Map <B>serviceMap</B></PRE>
<DL>
<DD>The service map.
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="deny"><!-- --></A><H3>
deny</H3>
<PRE>
private <A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.Rule.html" title="class in org.owasp.esapi.reference">FileBasedAccessController.Rule</A> <B>deny</B></PRE>
<DL>
<DD>A rule containing "deny".
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="logger"><!-- --></A><H3>
logger</H3>
<PRE>
private <A HREF="../../../../org/owasp/esapi/Logger.html" title="interface in org.owasp.esapi">Logger</A> <B>logger</B></PRE>
<DL>
<DD>The logger.
<P>
<DL>
</DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=1><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TD>
</TR>
</TABLE>

<A NAME="FileBasedAccessController()"><!-- --></A><H3>
FileBasedAccessController</H3>
<PRE>
public <B>FileBasedAccessController</B>()</PRE>
<DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TD COLSPAN=1><FONT SIZE="+2">
<B>Method Detail</B></FONT></TD>
</TR>
</TABLE>

<A NAME="isAuthorizedForURL(java.lang.String)"><!-- --></A><H3>
isAuthorizedForURL</H3>
<PRE>
public boolean <B>isAuthorizedForURL</B>(java.lang.String&nbsp;url)</PRE>
<DL>
<DD>Checks if an account is authorized to access the referenced URL. Generally, this method should be invoked in the
 application's controller or a filter as follows:
 <PRE>ESAPI.accessController().isAuthorizedForURL(request.getRequestURI().toString());</PRE>
 
 The implementation of this method should call assertAuthorizedForURL(String url), and if an AccessControlException is 
 not thrown, this method should return true. This way, if the user is not authorized, false would be returned, and the 
 exception would be logged.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../org/owasp/esapi/AccessController.html#isAuthorizedForURL(java.lang.String)">isAuthorizedForURL</A></CODE> in interface <CODE><A HREF="../../../../org/owasp/esapi/AccessController.html" title="interface in org.owasp.esapi">AccessController</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>url</CODE> - the URL as returned by request.getRequestURI().toString()
<DT><B>Returns:</B><DD>true, if is authorized for URL</DL>
</DD>
</DL>
<HR>

<A NAME="isAuthorizedForFunction(java.lang.String)"><!-- --></A><H3>
isAuthorizedForFunction</H3>
<PRE>
public boolean <B>isAuthorizedForFunction</B>(java.lang.String&nbsp;functionName)</PRE>
<DL>
<DD>Checks if an account is authorized to access the referenced function. 
 
 The implementation of this method should call assertAuthorizedForFunction(String functionName), and if an 
 AccessControlException is not thrown, this method should return true.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../org/owasp/esapi/AccessController.html#isAuthorizedForFunction(java.lang.String)">isAuthorizedForFunction</A></CODE> in interface <CODE><A HREF="../../../../org/owasp/esapi/AccessController.html" title="interface in org.owasp.esapi">AccessController</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>functionName</CODE> - the name of the function
<DT><B>Returns:</B><DD>true, if is authorized for function</DL>
</DD>
</DL>
<HR>

<A NAME="isAuthorizedForData(java.lang.String)"><!-- --></A><H3>
isAuthorizedForData</H3>
<PRE>
public boolean <B>isAuthorizedForData</B>(java.lang.String&nbsp;key)</PRE>
<DL>
<DD>{@inheritDoc}
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
</DL>
</DD>
</DL>
<HR>

<A NAME="isAuthorizedForData(java.lang.String, java.lang.Object)"><!-- --></A><H3>
isAuthorizedForData</H3>
<PRE>
public boolean <B>isAuthorizedForData</B>(java.lang.String&nbsp;action,
                                   java.lang.Object&nbsp;data)</PRE>
<DL>
<DD>Checks if an account is authorized to access the referenced data, represented as an Object. 
 
 The implementation of this method should call assertAuthorizedForData(String action, Object data), and if an 
 AccessControlException is not thrown, this method should return true.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../org/owasp/esapi/AccessController.html#isAuthorizedForData(java.lang.String, java.lang.Object)">isAuthorizedForData</A></CODE> in interface <CODE><A HREF="../../../../org/owasp/esapi/AccessController.html" title="interface in org.owasp.esapi">AccessController</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>action</CODE> - the action to check for in the configuration file in the resource directory<DD><CODE>data</CODE> - the data to check for in the configuration file in the resource directory
<DT><B>Returns:</B><DD>true, if is authorized for the data</DL>
</DD>
</DL>
<HR>

<A NAME="isAuthorizedForFile(java.lang.String)"><!-- --></A><H3>
isAuthorizedForFile</H3>
<PRE>
public boolean <B>isAuthorizedForFile</B>(java.lang.String&nbsp;filepath)</PRE>
<DL>
<DD>Checks if an account is authorized to access the referenced file. 
 
 The implementation of this method should call assertAuthorizedForFile(String filepath), and if an AccessControlException 
 is not thrown, this method should return true.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../org/owasp/esapi/AccessController.html#isAuthorizedForFile(java.lang.String)">isAuthorizedForFile</A></CODE> in interface <CODE><A HREF="../../../../org/owasp/esapi/AccessController.html" title="interface in org.owasp.esapi">AccessController</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>filepath</CODE> - the path of the file to be checked, including filename
<DT><B>Returns:</B><DD>true, if is authorized for the file</DL>
</DD>
</DL>
<HR>

<A NAME="isAuthorizedForService(java.lang.String)"><!-- --></A><H3>
isAuthorizedForService</H3>
<PRE>
public boolean <B>isAuthorizedForService</B>(java.lang.String&nbsp;serviceName)</PRE>
<DL>
<DD>Checks if an account is authorized to access the referenced service. This can be used in applications that
 provide access to a variety of back end services.
 
 The implementation of this method should call assertAuthorizedForService(String serviceName), and if an 
 AccessControlException is not thrown, this method should return true.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../org/owasp/esapi/AccessController.html#isAuthorizedForService(java.lang.String)">isAuthorizedForService</A></CODE> in interface <CODE><A HREF="../../../../org/owasp/esapi/AccessController.html" title="interface in org.owasp.esapi">AccessController</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>serviceName</CODE> - the service name
<DT><B>Returns:</B><DD>true, if is authorized for the service</DL>
</DD>
</DL>
<HR>

<A NAME="assertAuthorizedForURL(java.lang.String)"><!-- --></A><H3>
assertAuthorizedForURL</H3>
<PRE>
public void <B>assertAuthorizedForURL</B>(java.lang.String&nbsp;url)
                            throws <A HREF="../../../../org/owasp/esapi/errors/AccessControlException.html" title="class in org.owasp.esapi.errors">AccessControlException</A></PRE>
<DL>
<DD>Checks if an account is authorized to access the referenced URL. The implementation should allow
 access to be granted to any part of the URL. Generally, this method should be invoked in the
 application's controller or a filter as follows:
 <PRE>ESAPI.accessController().assertAuthorizedForURL(request.getRequestURI().toString());</PRE> 
 
 This method throws an AccessControlException if access is not authorized, or if the referenced URL does not exist.
 If the User is authorized, this method simply returns.
 <P>
 Specification:  The implementation should do the following:
 <ol>
 <li>Check to see if the resource exists and if not, throw an AccessControlException</li>
 <li>Use available information to make an access control decision</li>
      <ol type="a">
      <li>Ideally, this policy would be data driven</li>
 		<li>You can use the current User, roles, data type, data name, time of day, etc.</li>
  	<li>Access control decisions must deny by default</li>
      </ol>
 <li>If access is not permitted, throw an AccessControlException with details</li>
 </ol>
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../org/owasp/esapi/AccessController.html#assertAuthorizedForURL(java.lang.String)">assertAuthorizedForURL</A></CODE> in interface <CODE><A HREF="../../../../org/owasp/esapi/AccessController.html" title="interface in org.owasp.esapi">AccessController</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>url</CODE> - the URL as returned by request.getRequestURI().toString()
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../org/owasp/esapi/errors/AccessControlException.html" title="class in org.owasp.esapi.errors">AccessControlException</A></CODE> - if access is not permitted</DL>
</DD>
</DL>
<HR>

<A NAME="assertAuthorizedForFunction(java.lang.String)"><!-- --></A><H3>
assertAuthorizedForFunction</H3>
<PRE>
public void <B>assertAuthorizedForFunction</B>(java.lang.String&nbsp;functionName)
                                 throws <A HREF="../../../../org/owasp/esapi/errors/AccessControlException.html" title="class in org.owasp.esapi.errors">AccessControlException</A></PRE>
<DL>
<DD>Checks if an account is authorized to access the referenced function. The implementation should define the
 function "namespace" to be enforced. Choosing something simple like the class name of action classes or menu item
 names will make this implementation easier to use.
 <P>
 This method throws an AccessControlException if access is not authorized, or if the referenced function does not exist.
 If the User is authorized, this method simply returns.
 <P>
 Specification:  The implementation should do the following:
 <ol>
 <li>Check to see if the function exists and if not, throw an AccessControlException</li>
 <li>Use available information to make an access control decision</li>
      <ol type="a">
      <li>Ideally, this policy would be data driven</li>
 		<li>You can use the current User, roles, data type, data name, time of day, etc.</li>
  	<li>Access control decisions must deny by default</li>
      </ol>
 <li>If access is not permitted, throw an AccessControlException with details</li>
 </ol>
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../org/owasp/esapi/AccessController.html#assertAuthorizedForFunction(java.lang.String)">assertAuthorizedForFunction</A></CODE> in interface <CODE><A HREF="../../../../org/owasp/esapi/AccessController.html" title="interface in org.owasp.esapi">AccessController</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>functionName</CODE> - the function name
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../org/owasp/esapi/errors/AccessControlException.html" title="class in org.owasp.esapi.errors">AccessControlException</A></CODE> - if access is not permitted</DL>
</DD>
</DL>
<HR>

<A NAME="assertAuthorizedForData(java.lang.String)"><!-- --></A><H3>
assertAuthorizedForData</H3>
<PRE>
public void <B>assertAuthorizedForData</B>(java.lang.String&nbsp;key)
                             throws <A HREF="../../../../org/owasp/esapi/errors/AccessControlException.html" title="class in org.owasp.esapi.errors">AccessControlException</A></PRE>
<DL>
<DD>{@inheritDoc}
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../org/owasp/esapi/errors/AccessControlException.html" title="class in org.owasp.esapi.errors">AccessControlException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="assertAuthorizedForData(java.lang.String, java.lang.Object)"><!-- --></A><H3>
assertAuthorizedForData</H3>
<PRE>
public void <B>assertAuthorizedForData</B>(java.lang.String&nbsp;action,
                                    java.lang.Object&nbsp;data)
                             throws <A HREF="../../../../org/owasp/esapi/errors/AccessControlException.html" title="class in org.owasp.esapi.errors">AccessControlException</A></PRE>
<DL>
<DD>Checks if the current user is authorized to access the referenced data.  This method simply returns if access is authorized.  
 It throws an AccessControlException if access is not authorized, or if the referenced data does not exist.
 <P>
 Specification:  The implementation should do the following:
 <ol>
 <li>Check to see if the resource exists and if not, throw an AccessControlException</li>
 <li>Use available information to make an access control decision</li>
      <ol type="a">
      <li>Ideally, this policy would be data driven</li>
 		<li>You can use the current User, roles, data type, data name, time of day, etc.</li>
  	<li>Access control decisions must deny by default</li>
      </ol>
 <li>If access is not permitted, throw an AccessControlException with details</li>
 </ol>
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../org/owasp/esapi/AccessController.html#assertAuthorizedForData(java.lang.String, java.lang.Object)">assertAuthorizedForData</A></CODE> in interface <CODE><A HREF="../../../../org/owasp/esapi/AccessController.html" title="interface in org.owasp.esapi">AccessController</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>action</CODE> - the action to check for in the configuration file in the resource directory<DD><CODE>data</CODE> - the data to check for in the configuration file in the resource directory
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../org/owasp/esapi/errors/AccessControlException.html" title="class in org.owasp.esapi.errors">AccessControlException</A></CODE> - if access is not permitted</DL>
</DD>
</DL>
<HR>

<A NAME="assertAuthorizedForFile(java.lang.String)"><!-- --></A><H3>
assertAuthorizedForFile</H3>
<PRE>
public void <B>assertAuthorizedForFile</B>(java.lang.String&nbsp;filepath)
                             throws <A HREF="../../../../org/owasp/esapi/errors/AccessControlException.html" title="class in org.owasp.esapi.errors">AccessControlException</A></PRE>
<DL>
<DD>Checks if an account is authorized to access the referenced file. The implementation should validate and canonicalize the 
 input to be sure the filepath is not malicious.
 <P>
 This method throws an AccessControlException if access is not authorized, or if the referenced File does not exist.
 If the User is authorized, this method simply returns.
 <P>
 Specification:  The implementation should do the following:
 <ol>
 <li>Check to see if the File exists and if not, throw an AccessControlException</li>
 <li>Use available information to make an access control decision</li>
      <ol type="a">
      <li>Ideally, this policy would be data driven</li>
 		<li>You can use the current User, roles, data type, data name, time of day, etc.</li>
  	<li>Access control decisions must deny by default</li>
      </ol>
 <li>If access is not permitted, throw an AccessControlException with details</li>
 </ol>
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../org/owasp/esapi/AccessController.html#assertAuthorizedForFile(java.lang.String)">assertAuthorizedForFile</A></CODE> in interface <CODE><A HREF="../../../../org/owasp/esapi/AccessController.html" title="interface in org.owasp.esapi">AccessController</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>filepath</CODE> - Path to the file to be checked
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../org/owasp/esapi/errors/AccessControlException.html" title="class in org.owasp.esapi.errors">AccessControlException</A></CODE> - if access is denied</DL>
</DD>
</DL>
<HR>

<A NAME="assertAuthorizedForService(java.lang.String)"><!-- --></A><H3>
assertAuthorizedForService</H3>
<PRE>
public void <B>assertAuthorizedForService</B>(java.lang.String&nbsp;serviceName)
                                throws <A HREF="../../../../org/owasp/esapi/errors/AccessControlException.html" title="class in org.owasp.esapi.errors">AccessControlException</A></PRE>
<DL>
<DD>Checks if an account is authorized to access the referenced service. This can be used in applications that
 provide access to a variety of backend services.
 <P>
 This method throws an AccessControlException if access is not authorized, or if the referenced service does not exist.
 If the User is authorized, this method simply returns.
 <P>
 Specification:  The implementation should do the following:
 <ol>
 <li>Check to see if the service exists and if not, throw an AccessControlException</li>
 <li>Use available information to make an access control decision</li>
      <ol type="a">
      <li>Ideally, this policy would be data driven</li>
 		<li>You can use the current User, roles, data type, data name, time of day, etc.</li>
  	<li>Access control decisions must deny by default</li>
      </ol>
 <li>If access is not permitted, throw an AccessControlException with details</li>
 </ol>
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../org/owasp/esapi/AccessController.html#assertAuthorizedForService(java.lang.String)">assertAuthorizedForService</A></CODE> in interface <CODE><A HREF="../../../../org/owasp/esapi/AccessController.html" title="interface in org.owasp.esapi">AccessController</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>serviceName</CODE> - the service name
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../org/owasp/esapi/errors/AccessControlException.html" title="class in org.owasp.esapi.errors">AccessControlException</A></CODE> - if access is not permitted</DL>
</DD>
</DL>
<HR>

<A NAME="matchRule(java.util.Map, java.lang.String)"><!-- --></A><H3>
matchRule</H3>
<PRE>
private boolean <B>matchRule</B>(java.util.Map&nbsp;map,
                          java.lang.String&nbsp;path)</PRE>
<DL>
<DD>Checks to see if the current user has access to the specified data, File, Object, etc.
 If the User has access, as specified by the map parameter, this method returns true.  If the 
 User does not have access or an exception is thrown, false is returned.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>map</CODE> - the map containing access rules<DD><CODE>path</CODE> - the path of the requested File, URL, Object, etc.
<DT><B>Returns:</B><DD>true, if the user has access, false otherwise</DL>
</DD>
</DL>
<HR>

<A NAME="matchRule(java.util.Map, java.lang.Class, java.lang.String)"><!-- --></A><H3>
matchRule</H3>
<PRE>
private boolean <B>matchRule</B>(java.util.Map&nbsp;map,
                          java.lang.Class&nbsp;clazz,
                          java.lang.String&nbsp;action)</PRE>
<DL>
<DD>Checks to see if the current user has access to the specified Class and action.
 If the User has access, as specified by the map parameter, this method returns true.
 If the User does not have access or an exception is thrown, false is returned.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>map</CODE> - the map containing access rules<DD><CODE>clazz</CODE> - the Class being requested for access<DD><CODE>action</CODE> - the action the User has asked to perform
<DT><B>Returns:</B><DD>true, if the user has access, false otherwise</DL>
</DD>
</DL>
<HR>

<A NAME="searchForRule(java.util.Map, java.util.Set, java.lang.String)"><!-- --></A><H3>
searchForRule</H3>
<PRE>
private <A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.Rule.html" title="class in org.owasp.esapi.reference">FileBasedAccessController.Rule</A> <B>searchForRule</B>(java.util.Map&nbsp;map,
                                                     java.util.Set&nbsp;roles,
                                                     java.lang.String&nbsp;path)</PRE>
<DL>
<DD>Search for rule. Four mapping rules are used in order: - exact match,
 e.g. /access/login - longest path prefix match, beginning / and ending
 /*, e.g. /access/* or /* - extension match, beginning *., e.g. *.css -
 default servlet, specified by the single character pattern /
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>map</CODE> - the map containing access rules<DD><CODE>roles</CODE> - the roles of the User being checked for access<DD><CODE>path</CODE> - the File, URL, Object, etc. being checked for access
<DT><B>Returns:</B><DD>the rule stating whether to allow or deny access</DL>
</DD>
</DL>
<HR>

<A NAME="searchForRule(java.util.Map, java.util.Set, java.lang.Class, java.lang.String)"><!-- --></A><H3>
searchForRule</H3>
<PRE>
private <A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.Rule.html" title="class in org.owasp.esapi.reference">FileBasedAccessController.Rule</A> <B>searchForRule</B>(java.util.Map&nbsp;map,
                                                     java.util.Set&nbsp;roles,
                                                     java.lang.Class&nbsp;clazz,
                                                     java.lang.String&nbsp;action)</PRE>
<DL>
<DD>Search for rule. Searches the specified access map to see if any of the roles specified have 
 access to perform the specified action on the specified Class.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>map</CODE> - the map containing access rules<DD><CODE>roles</CODE> - the roles used to determine access level<DD><CODE>clazz</CODE> - the Class being requested for access<DD><CODE>action</CODE> - the action the User has asked to perform
<DT><B>Returns:</B><DD>the rule that allows the specified roles access to perform the requested action on the specified Class, or null if access is not granted</DL>
</DD>
</DL>
<HR>

<A NAME="overlap(java.util.Set, java.util.Set)"><!-- --></A><H3>
overlap</H3>
<PRE>
private boolean <B>overlap</B>(java.util.Set&nbsp;ruleRoles,
                        java.util.Set&nbsp;userRoles)</PRE>
<DL>
<DD>Return true if there is overlap between the two sets.  This method merely checks to see if 
 ruleRoles contains any of the roles listed in userRoles.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>ruleRoles</CODE> - the rule roles<DD><CODE>userRoles</CODE> - the user roles
<DT><B>Returns:</B><DD>true, if any roles exist in both Sets.  False otherwise.</DL>
</DD>
</DL>
<HR>

<A NAME="overlap(java.util.List, java.lang.String)"><!-- --></A><H3>
overlap</H3>
<PRE>
private boolean <B>overlap</B>(java.util.List&nbsp;ruleActions,
                        java.lang.String&nbsp;action)</PRE>
<DL>
<DD>This method merely checks to see if ruleActions contains the action requested.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>ruleActions</CODE> - actions listed for a rule<DD><CODE>action</CODE> - the action requested that will be searched for in ruleActions
<DT><B>Returns:</B><DD>true, if any action exists in ruleActions.  False otherwise.</DL>
</DD>
</DL>
<HR>

<A NAME="validateRoles(java.util.List)"><!-- --></A><H3>
validateRoles</H3>
<PRE>
private java.util.List <B>validateRoles</B>(java.util.List&nbsp;roles)</PRE>
<DL>
<DD>Checks that the roles passed in contain only letters, numbers, and underscores.  Also checks that
 roles are no more than 10 characters long.  If a role does not pass validation, it is not included in the 
 list of roles returned by this method.  A log warning is also generated for any invalid roles.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>roles</CODE> - roles to validate according to criteria started above
<DT><B>Returns:</B><DD>a List of roles that are valid according to the criteria stated above.</DL>
</DD>
</DL>
<HR>

<A NAME="loadRules(java.lang.String)"><!-- --></A><H3>
loadRules</H3>
<PRE>
private java.util.Map <B>loadRules</B>(java.lang.String&nbsp;ruleset)</PRE>
<DL>
<DD>Loads access rules by storing them in a hashmap.  This method begins reading the File specified by
 the ruleset parameter, ignoring any lines that begin with '#' characters as comments.  Sections of the access rules file
 are split by the pipe character ('|').  The method loads all paths, replacing '\' characters with '/' for uniformity then loads
 the list of comma separated roles. The roles are validated to be sure they are within a 
 length and character set, specified in the validateRoles(String) method.  Then the permissions are stored for each item in the rules list.
 If the word "allow" appears on the line, the specified roles are granted access to the data - otherwise, they will be denied access.
 
 Each path may only appear once in the access rules file.  Any entry, after the first, containing the same path will be logged and ignored.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>ruleset</CODE> - the name of the data that contains access rules
<DT><B>Returns:</B><DD>a hash map containing the ruleset</DL>
</DD>
</DL>
<HR>

<A NAME="loadDataRules(java.lang.String)"><!-- --></A><H3>
loadDataRules</H3>
<PRE>
private java.util.Map <B>loadDataRules</B>(java.lang.String&nbsp;ruleset)</PRE>
<DL>
<DD>Loads access rules by storing them in a hashmap.  This method begins reading the File specified by
 the ruleset parameter, ignoring any lines that begin with '#' characters as comments.  Sections of the access rules file
 are split by the pipe character ('|').  The method then loads all Classes, loads the list of comma separated roles, then the list of comma separated actions.  
 The roles are validated to be sure they are within a length and character set, specified in the validateRoles(String) method.  
 
 Each path may only appear once in the access rules file.  Any entry, after the first, containing the same path will be logged and ignored.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>ruleset</CODE> - the name of the data that contains access rules
<DT><B>Returns:</B><DD>a hash map containing the ruleset</DL>
</DD>
</DL>
<HR>

<A NAME="commaSplit(java.lang.String)"><!-- --></A><H3>
commaSplit</H3>
<PRE>
private java.util.List <B>commaSplit</B>(java.lang.String&nbsp;input)</PRE>
<DL>
<DD>This method splits a String by the ',' and returns the result as a List.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>input</CODE> - the String to split by ','
<DT><B>Returns:</B><DD>a List where each entry was on either side of a ',' in the original String</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=3 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/FileBasedAccessController.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../index-files/index-1.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../org/owasp/esapi/reference/DefaultValidator.html" title="class in org.owasp.esapi.reference"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../org/owasp/esapi/reference/FileBasedAccessController.Rule.html" title="class in org.owasp.esapi.reference"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../index.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="FileBasedAccessController.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>

</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;<A HREF="#nested_class_summary">NESTED</A>&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>

</BODY>
</HTML>
